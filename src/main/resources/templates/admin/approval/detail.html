<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>결재 상세 보기</title>
</head>
<body>
<h2>결재 상세 보기</h2>

<table border="1">
  <tr><th>제목</th><td th:text="${approval.title}">제목</td></tr>
  <tr><th>내용</th><td th:text="${approval.content}">내용</td></tr>
  <tr><th>작성자</th>
    <td th:text="${approval.writer != null ? approval.writer.adminname : '알 수 없음'}">작성자</td></tr>
  <tr><th>상태</th><td th:text="${approval.status}">상태</td></tr>
  <tr th:if="${approval.rejectReason != null}">
    <th>반려사유</th><td th:text="${approval.rejectReason}">사유</td>
  </tr>
  <tr><th>작성일</th><td th:text="${#temporals.format(approval.regDate, 'yyyy-MM-dd HH:mm')}">작성일</td></tr>
</table>

<!-- 승인자용 버튼 -->
<div th:if="${admin != null and (admin.role == 'APPROVER' or admin.role == 'SUPER')}">
  <div th:if="${approval.status == '결재대기'}">
    <form th:action="@{'/admin/approval/approve/' + ${approval.approvalId}}" method="post" style="display:inline;">
      <button type="submit">승인 (배포대기)</button>
    </form>
    <form th:action="@{'/admin/approval/reject/' + ${approval.approvalId}}" method="post" style="display:inline;">
      <div style="margin-top: 10px;">
        <label for="rejectReason">반려 사유:</label><br>
        <textarea id="rejectReason" name="reason" rows="4" cols="40" placeholder="반려 사유를 입력하세요" required></textarea>
      </div>
      <button type="submit" style="margin-top: 5px;">반려</button>
    </form>
  </div>
</div>

<br>
<a th:href="@{/admin/approval/manage}">← 목록으로</a>
</body>
</html>