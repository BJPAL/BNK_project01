<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <body>
    <aside th:fragment="adminAside" class="admin-aside">
      <nav>
        <ul class="menu-list">
          <li>
            <h1 class="semi-title">Fund Admin</h1>
          </li>
          <li class="line"></li>
          <!-- ─── 펀드 상품 관리 ─── -->
          <li class="menu-group" th:if="${session.admin.role == 'planner'}">
            <button type="button" class="group-btn">
              펀드 상품 관리
              <span class="arrow"></span>
            </button>
            <ul class="submenu">
              <li><a th:href="@{/admin/fund/list}">펀드 조회</a></li>
              <li><a th:href="@{/admin/fund/new}">펀드 등록</a></li>
              <li><a th:href="@{/admin/fund/edit}">펀드 수정</a></li>
            </ul>
          </li>

          <!-- ─── 상품 통계 ─── -->
          <li class="menu-group" th:if="${session.admin.role == 'super'}">
            <button type="button" class="group-btn">
              상품 통계
              <span class="arrow"></span>
            </button>
            <ul class="submenu">
              <li><a th:href="@{/admin/statistics}">통계 보기</a></li>
            </ul>
          </li>

          <!-- ─── 결재 업무(approver) ─── -->
          <li class="menu-group" th:if="${session.admin.role == 'approver'}">
            <button type="button" class="group-btn">결재 업무</button>
          </li>

          <!-- ─── 문서함(planner) ─── -->
          <li class="menu-group" th:if="${session.admin.role == 'planner'}">
            <button type="button" class="group-btn">문서함</button>
          </li>

          <!-- ─── 1:1문의 관리(cs) ─── -->
          <li th:if="${session.admin.role == 'cs'}" class="menu-group">
            <button
              type="button"
              class="group-btn"
              onclick="qnaLink()"
              data-url="/admin/qnaList"
            >
              1:1 문의 관리
            </button>
          </li>

          <!-- ─── FAQ 관리(cs) ─── -->
          <li th:if="${session.admin.role == 'cs'}" class="menu-group">
            <button
              type="button"
              class="group-btn"
              onclick="faqLink()"
              data-url="/admin/faq/list"
            >
              FAQ 관리
            </button>
          </li>

          <!-- ─── 관리자 설정(super only) ─── -->
          <li th:if="${session.admin.role == 'super'}" class="menu-group">
            <button
              type="button"
              class="group-btn"
              onclick="link()"
              data-url="/admin/adminSetting"
            >
              관리자 설정
            </button>
          </li>
        </ul>
        <!-- 아코디언 토글 스크립트 -->
        <script th:inline="javascript">
          document
            .querySelectorAll(".admin-aside .group-btn")
            .forEach((btn) => {
              btn.addEventListener("click", () => {
                const grp = btn.closest(".menu-group");
                grp.classList.toggle("open");
              });
            });
          function link() {
            location.href = "/admin/adminSetting";
          }
          function qnaLink() {
            location.href = "/admin/qnaList";
          }
          function faqLink() {
            location.href = "/admin/faq/list";
          }

          document.addEventListener("DOMContentLoaded", () => {
            const path = window.location.pathname;
            document
              .querySelectorAll(".admin-aside .group-btn[data-url]")
              .forEach((btn) => {
                const target = btn.getAttribute("data-url");
                if (path.startsWith(target)) {
                  btn.classList.add("active");
                  // 아코디언도 열어두기
                  const grp = btn.closest(".menu-group");
                  if (grp) grp.classList.add("open");
                }
              });
          });
        </script>
      </nav>
    </aside>
  </body>
</html>
