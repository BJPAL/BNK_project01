<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="/css/fund/fund_list.css" />
        <title>í€ë“œ íˆ¬ì - ë§ì¶¤ ì¶”ì²œ</title>
    </head>
    <body>
        <div class="container">
            <!-- ì œëª© ì˜ì—­ -->
            <div class="title-container">
                <h1 class="title">ë§ì¶¤ í€ë“œ ì¶”ì²œ</h1>
                <span class="title-user-info">
                    í˜„ì¬ íšŒì›ë‹˜ì˜ íˆ¬ìì„±í–¥ì€
                    <span id="invest-type">Unknown</span>ì…ë‹ˆë‹¤
                </span>
            </div>

            <!-- í•„í„° ì˜ì—­ -->
            <form id="fundForm" class="filter-container">
                <!-- ìœ„í—˜ë“±ê¸‰ -->
                <fieldset class="row">
                    <legend class="row-label">ìœ„í—˜ë“±ê¸‰</legend>
                    <div class="options">
                        <label for="risk1">
                            <input
                                type="checkbox"
                                id="risk1"
                                name="risk"
                                value="1"
                            />
                            ë§¤ìš°ë†’ì€ìœ„í—˜(1ë“±ê¸‰)
                        </label>

                        <label for="risk2">
                            <input
                                type="checkbox"
                                id="risk2"
                                name="risk"
                                value="2"
                            />
                            ë†’ì€ìœ„í—˜(2ë“±ê¸‰)
                        </label>

                        <label for="risk3">
                            <input
                                type="checkbox"
                                id="risk3"
                                name="risk"
                                value="3"
                            />
                            ë‹¤ì†Œë†’ì€ìœ„í—˜(3ë“±ê¸‰)
                        </label>

                        <label for="risk4">
                            <input
                                type="checkbox"
                                id="risk4"
                                name="risk"
                                value="4"
                            />
                            ë³´í†µìœ„í—˜(4ë“±ê¸‰)
                        </label>

                        <label for="risk5">
                            <input
                                type="checkbox"
                                id="risk5"
                                name="risk"
                                value="5"
                            />
                            ë‚®ì€ìœ„í—˜(5ë“±ê¸‰)
                        </label>

                        <label for="risk6">
                            <input
                                type="checkbox"
                                id="risk6"
                                name="risk"
                                value="6"
                            />
                            ë§¤ìš°ë‚®ì€ìœ„í—˜(6ë“±ê¸‰)
                        </label>
                    </div>
                </fieldset>

                <!-- í€ë“œìœ í˜• -->
                <fieldset class="row">
                    <legend class="row-label">í€ë“œìœ í˜•</legend>
                    <div class="options">
                        <label for="type_mmf">
                            <input
                                type="checkbox"
                                id="type_mmf"
                                name="type"
                                value="MMF"
                            />
                            MMF
                        </label>

                        <label for="type_bond">
                            <input
                                type="checkbox"
                                id="type_bond"
                                name="type"
                                value="ì±„ê¶Œí˜•"
                            />
                            ì±„ê¶Œí˜•
                        </label>

                        <label for="type_bmix">
                            <input
                                type="checkbox"
                                id="type_bmix"
                                name="type"
                                value="ì±„ê¶Œí˜¼í•©í˜•"
                            />
                            ì±„ê¶Œí˜¼í•©í˜•
                        </label>

                        <label for="type_smix">
                            <input
                                type="checkbox"
                                id="type_smix"
                                name="type"
                                value="ì£¼ì‹í˜¼í•©í˜•"
                            />
                            ì£¼ì‹í˜¼í•©í˜•
                        </label>

                        <label for="type_stock">
                            <input
                                type="checkbox"
                                id="type_stock"
                                name="type"
                                value="ì£¼ì‹í˜•"
                            />
                            ì£¼ì‹í˜•
                        </label>

                        <label for="type_deriv">
                            <input
                                type="checkbox"
                                id="type_deriv"
                                name="type"
                                value="íŒŒìƒìƒí’ˆí˜•"
                            />
                            íŒŒìƒìƒí’ˆí˜•
                        </label>

                        <label for="type_fof">
                            <input
                                type="checkbox"
                                id="type_fof"
                                name="type"
                                value="ì¬ê°„ì ‘"
                            />
                            ì¬ê°„ì ‘
                        </label>
                    </div>
                </fieldset>

                <!-- íˆ¬ì ì§€ì—­ -->
                <fieldset class="row">
                    <legend class="row-label">íˆ¬ì ì§€ì—­</legend>
                    <div class="options">
                        <label for="reg_kr">
                            <input
                                type="checkbox"
                                id="reg_kr"
                                name="region"
                                value="í•œêµ­"
                            />
                            êµ­ë‚´
                        </label>

                        <label for="reg_gl">
                            <input
                                type="checkbox"
                                id="reg_gl"
                                name="region"
                                value="ê¸€ë¡œë²Œ"
                            />
                            ê¸€ë¡œë²Œ
                        </label>
                    </div>
                </fieldset>

                <!-- ê²€ìƒ‰ ë²„íŠ¼ -->
                <div class="row filter-btn-container">
                    <button type="submit" class="filter-btn">í•„í„° ê²€ìƒ‰</button>
                </div>
            </form>

            <div id="fund-content" class="fund-content">
                <!-- ê²€ìƒ‰ ê²°ê³¼ ë©”ì„¸ì§€ ì˜ì—­ -->
                <div class="message"></div>

                <!-- í€ë“œ ë¦¬ìŠ¤íŠ¸ ì˜ì—­ -->
                <div id="fund-list" class="fund-list">
                    <!-- í€ë“œ ì•„ì´í…œ ì˜ì—­ -->
                </div>

                <!-- ë”ë³´ê¸° ë²„íŠ¼ ì˜ì—­ -->
                <div class="load-more-container">
                    <button
                        id="load-more-btn"
                        class="load-more-btn"
                        onclick="loadMoreFunds()"
                    >
                        ë”ë³´ê¸°
                    </button>
                </div>
            </div>

            <!-- â”€â”€ ë¡œë”© ì˜¤ë²„ë ˆì´ â”€â”€ -->
            <div id="loading" class="loading" hidden>
                <div class="spinner"></div>
                <p>í€ë“œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
            </div>
        </div>

        <footer class="page-footer">
            <div class="footer-inner">
                <!-- íšŒì‚¬Â·ì„œë¹„ìŠ¤ ì •ë³´ -->
                <section class="footer-info">
                    <h4 class="footer-logo">FUND<span>INFO</span></h4>
                    <p>
                        (ì£¼) í€ë“œì¸í¬ &nbsp;|&nbsp; ëŒ€í‘œâ€¯í™ê¸¸ë™ &nbsp;|&nbsp;
                        ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸Â 123â€‘45â€‘67890<br />
                        ì„œìš¸íŠ¹ë³„ì‹œ ì˜ë“±í¬êµ¬ ì—¬ì˜ëŒ€ë¡œÂ 97Â 3F&nbsp;Â (Â ìš°Â 07320Â )
                    </p>
                    <p class="copyright">
                        Â©Â 2025Â FUNDINFOâ€¯Co.,Â Ltd. AllÂ rightsÂ reserved.
                    </p>
                </section>

                <!-- ë©”ë‰´ ë§í¬ -->
                <nav class="footer-nav">
                    <ul>
                        <li><a href="#">ì„œë¹„ìŠ¤ ì†Œê°œ</a></li>
                        <li><a href="#">ì´ìš©ì•½ê´€</a></li>
                        <li><a href="#">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a></li>
                        <li><a href="#">ê³ ê°ì„¼í„°</a></li>
                    </ul>
                </nav>

                <!-- SNS / ì—°ë½ì²˜ -->
                <section class="footer-contact">
                    <p>
                        <strong>ê³ ê°ì„¼í„°Â |Â 1588â€‘0000</strong
                        ><br />í‰ì¼Â 09:00â€‘18:00
                    </p>
                    <div class="sns">
                        <a href="#" aria-label="í˜ì´ìŠ¤ë¶">ğŸ“˜</a>
                        <a href="#" aria-label="íŠ¸ìœ„í„°">ğŸ¦</a>
                        <a href="#" aria-label="ë§í¬ë“œì¸">ğŸ’¼</a>
                    </div>
                </section>
            </div>
        </footer>

        <script>
            // ì „ì—­ ë³€ìˆ˜
            let currentPage = 1; // í˜„ì¬ ë¡œë”©í•  í˜ì´ì§€ ë²ˆí˜¸ë¥¼ ì €ì¥
            let pageSize = 10; // í˜ì´ì§€ì˜ ìµœëŒ€ ìš”ì²­ ê°¯ìˆ˜
            let isLoading = false; // í˜„ì¬ API í˜¸ì¶œ ì¤‘ì¸ì§€ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” í”Œë˜ê·¸
            let hasMoreData = true; // ë” ê°€ì ¸ì˜¬ ë°ì´í„°ê°€ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í”Œë˜ê·¸
            let investType = null; // ì‚¬ìš©ìì˜ íˆ¬ì ì„±í–¥ íƒ€ì… ë²ˆí˜¸ë¥¼ ì €ì¥
            let investTypeName = ""; // íˆ¬ì ì„±í–¥ íƒ€ì…ì˜ í•œê¸€ ì´ë¦„ì„ ì €ì¥
            let currentFilters = ""; // í˜„ì¬ í•„í„°

            // ê°ì²´
            const loading = document.getElementById("loading");

            // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
            // HTML ë¬¸ì„œê°€ ì™„ì „íˆ ë¡œë“œëœ í›„ ì´ˆê¸°í™” ì‘ì—… ìˆ˜í–‰
            document.addEventListener("DOMContentLoaded", function () {
                // Thymeleafì—ì„œ ì „ë‹¬ëœ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                // ë©”íƒ€ íƒœê·¸ ê²€ìƒ‰: document.querySelector()ë¡œ HTMLì˜ ë©”íƒ€ íƒœê·¸ì—ì„œ íˆ¬ì ì„±í–¥ ì •ë³´ ì°¾ê¸°
                const investTypeElement = document.querySelector(
                    'meta[name="invest-type"]'
                );
                const userIdElement = document.querySelector(
                    'meta[name="user-id"]'
                );

                // ë°ì´í„° íŒŒì‹±: parseInt()ë¡œ ë¬¸ìì—´ì„ ìˆ«ìë¡œ ë³€í™˜í•˜ì—¬ investType ë³€ìˆ˜ì— ì €ì¥
                if (investTypeElement) {
                    investType = parseInt(
                        investTypeElement.getAttribute("content")
                    );
                }

                // í•„í„° ì´ˆê¸°í™”
                currentFilters = "";

                // íˆ¬ì ì„±í–¥ ì •ë³´ ì„¤ì •
                // setInvestTypeInfo() í˜¸ì¶œë¡œ í™”ë©´ì— í‘œì‹œí•  íˆ¬ì ì„±í–¥ ì´ë¦„ ì„¤ì •
                setInvestTypeInfo();

                // ì´ˆê¸° ë°ì´í„° ë¡œë“œ
                // loadMoreFunds() í˜¸ì¶œë¡œ ì²« ë²ˆì§¸ í˜ì´ì§€ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                loadMoreFunds();
            });

            // ë” ë§ì€ í€ë“œ ë¡œë“œ
            // ì„œë²„ì—ì„œ í€ë“œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ í™”ë©´ì— ì¶”ê°€í•˜ëŠ” í•µì‹¬ í•¨ìˆ˜
            async function loadMoreFunds() {
                // ì¤‘ë³µ í˜¸ì¶œ ë°©ì§€
                if (isLoading || !hasMoreData) return;

                // ë¡œë”© ìƒíƒœ ì„¤ì •
                isLoading = true;
                showLoading(isLoading);
                updateLoadMoreButton();

                // ì²« í˜ì´ì§€ ë¡œë“œì¸ì§€ í™•ì¸
                const isFirstLoad = currentPage === 1;

                try {
                    // íŒŒë¼ë¯¸í„°
                    let apiUrl = `/api/funds/list?page=${currentPage}&limit=${pageSize}&investType=${investType}`;

                    // í•„í„° íŒŒë¼ë¯¸í„°ê°€ ìˆìœ¼ë©´ ì¶”ê°€
                    if (currentFilters) {
                        apiUrl += `&${currentFilters}`;
                    }

                    console.log("API ìš”ì²­ URL:", apiUrl); // ë””ë²„ê¹…ìš©

                    // API í˜¸ì¶œ
                    const response = await fetch(apiUrl);
                    const data = await response.json();

                    if (data.success) {
                        // ì„±ê³µ ì‹œ ë°ì´í„° ì²˜ë¦¬
                        const funds = data.data.funds;
                        const pagination = data.pagination;

                        console.log("======= ã…‹ã…‹ =======");
                        console.log(funds);
                        console.log(pagination);
                        console.log("======= ã…‹ã…‹ =======");

                        // í€ë“œ ëª©ë¡ ë Œë”ë§
                        renderFunds(funds);

                        // ê²°ê³¼ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸ (ì²« ë¡œë“œì¼ ë•Œë§Œ)
                        if (isFirstLoad) {
                            updateResultMessage(pagination.total, true);
                        }

                        // í˜ì´ì§€ ì •ë³´ ì—…ë°ì´íŠ¸
                        currentPage++;
                        hasMoreData = pagination.hasNext;

                        // ë”ë³´ê¸° ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
                        const loadMoreBtn =
                            document.getElementById("load-more-btn");

                        if (!hasMoreData) {
                            loadMoreBtn.style.display = "none";
                        } else {
                            // ë”ë³´ê¸° ë²„íŠ¼ì´ ìˆ¨ê²¨ì ¸ ìˆë‹¤ë©´ ë‹¤ì‹œ ë³´ì´ê²Œ í•¨
                            loadMoreBtn.style.display = "block";
                        }

                        // ì—ëŸ¬ ë©”ì‹œì§€ ì œê±°
                        // clearErrorMessage();
                        console.log("í€ë“œ ë°ì´í„° ê°–ê³  ì˜´");
                    } else {
                        console.log("í€ë“œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤");
                        if (isFirstLoad) {
                            updateResultMessage(0, true);
                        }
                        // ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ì²˜ë¦¬
                        // showErrorMessage(
                        //     data.message ||
                        //         "í€ë“œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."
                        // );
                    }
                } catch (error) {
                    // ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì²˜ë¦¬
                    console.error("í€ë“œ ë¡œë“œ ì˜¤ë¥˜:", error);
                    if (isFirstLoad) {
                        updateResultMessage(0, true);
                    }
                    // showErrorMessage(
                    //     "ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."
                    // );
                } finally {
                    // ë¡œë”© ìƒíƒœ í•´ì œ
                    isLoading = false;
                    showLoading(isLoading);
                    updateLoadMoreButton();
                }
            }

            // í€ë“œ ëª©ë¡ ë Œë”ë§
            // í€ë“œ ë°°ì—´ì„ ë°›ì•„ì„œ í™”ë©´ì— ë Œë”ë§
            function renderFunds(funds) {
                // í€ë“œ ëª©ë¡ì„ ë‹´ì„ ì»¨í…Œì´ë„ˆ ìš”ì†Œ ì°¾ê¸°
                const fundList = document.getElementById("fund-list");

                funds.forEach((fund) => {
                    // ê° í€ë“œì˜ HTML ìš”ì†Œ ìƒì„±
                    const fundElement = createFundElement(fund);
                    // ìƒì„±ëœ ìš”ì†Œë¥¼ ì»¨í…Œì´ë„ˆì— ì¶”ê°€
                    fundList.appendChild(fundElement);
                });
            }

            // í€ë“œ ìš”ì†Œ ìƒì„±
            // ê°œë³„ í€ë“œ ë°ì´í„°ë¥¼ HTML ìš”ì†Œë¡œ ë³€í™˜
            function createFundElement(fund) {
                const fundDiv = document.createElement("div");
                fundDiv.className = "fund-item";
                fundDiv.setAttribute("data-id", fund.fundId);

                // ìˆ˜ìµë¥  í´ë˜ìŠ¤ ê²°ì • í•¨ìˆ˜
                const getReturnClass = (value) => {
                    if (value === null || value === undefined) return "";
                    return value >= 0 ? "pos" : "neg";
                };

                // ìˆ˜ìµë¥  í¬ë§·íŒ… í•¨ìˆ˜
                const formatReturn = (value) => {
                    if (value === null || value === undefined) return "0.00%";
                    return `${value.toFixed(2)}%`;
                };

                // ìˆ«ì í¬ë§·íŒ… í•¨ìˆ˜
                const formatNumber = (value) => {
                    if (value === null || value === undefined) return "0";
                    return value.toLocaleString();
                };

                // ë‚ ì§œ í¬ë§·íŒ… í•¨ìˆ˜
                const formatDate = (dateStr) => {
                    if (!dateStr) return "";
                    // LocalDateëŠ” "YYYY-MM-DD" í˜•íƒœë¡œ ì˜¤ë¯€ë¡œ "-"ë¥¼ "."ë¡œ ë³€ê²½
                    return dateStr.replace(/-/g, ".");
                };

                // ìœ„í—˜ë“±ê¸‰ í´ë˜ìŠ¤ ê²°ì •
                const getRiskClass = (riskLevel) => {
                    return `risk-${riskLevel}`;
                };

                // ìœ„í—˜ë“±ê¸‰ í…ìŠ¤íŠ¸ ê²°ì •
                const getRiskText = (riskLevel) => {
                    const riskTexts = {
                        1: "ë§¤ìš°ë†’ì€ìœ„í—˜(1ë“±ê¸‰)",
                        2: "ë†’ì€ìœ„í—˜(2ë“±ê¸‰)",
                        3: "ë‹¤ì†Œë†’ì€ìœ„í—˜(3ë“±ê¸‰)",
                        4: "ë³´í†µìœ„í—˜(4ë“±ê¸‰)",
                        5: "ë‚®ì€ìœ„í—˜(5ë“±ê¸‰)",
                        6: "ë§¤ìš°ë‚®ì€ìœ„í—˜(6ë“±ê¸‰)",
                    };
                    return riskTexts[riskLevel] || `ìœ„í—˜ë“±ê¸‰(${riskLevel}ë“±ê¸‰)`;
                };

                fundDiv.innerHTML = `
        <!-- ë©”íƒ€ ë°ì´í„° -->
        <section class="fund-item-section fund-meta">
            <div class="fund-name-container">
                <h3 class="fund-name">
                    ${fund.fundName || ""}
                </h3>
            </div>
            <ul class="fund-detail">
                <li>ì„¤ì •ì¼&nbsp;${formatDate(fund.establishDate)}</li>
                <li>ê¸°ì¤€ê°€&nbsp;${formatNumber(fund.nav)}</li>
                <li>ìˆœìì‚°&nbsp;${fund.aum || 0}ì–µ</li>
            </ul>
            <div class="badge-list">
                <span class="badge company">${
                    fund.managementCompany || ""
                }</span>
                <span class="badge type">${fund.fundType || ""}</span>
                <span class="badge region">${fund.investmentRegion || ""}</span>
                <span class="badge risk ${getRiskClass(fund.riskLevel)}">
                    ${getRiskText(fund.riskLevel)}
                </span>
            </div>
        </section>

        <!-- ìˆ˜ìµë¥  -->
        <section class="fund-item-section fund-return">
            <div class="stat">
                <span>1ê°œì›”</span>
                <strong class="${getReturnClass(fund.return1m)}">${formatReturn(
                    fund.return1m
                )}</strong>
            </div>
            <div class="stat">
                <span>3ê°œì›”</span>
                <strong class="${getReturnClass(fund.return3m)}">${formatReturn(
                    fund.return3m
                )}</strong>
            </div>
            <div class="stat">
                <span>6ê°œì›”</span>
                <strong class="${getReturnClass(fund.return6m)}">${formatReturn(
                    fund.return6m
                )}</strong>
            </div>
            <div class="stat">
                <span>12ê°œì›”</span>
                <strong class="${getReturnClass(
                    fund.return12m
                )}">${formatReturn(fund.return12m)}</strong>
            </div>
            <div class="stat">
                <span>ëˆ„ì </span>
                <strong class="${getReturnClass(
                    fund.returnSince
                )}">${formatReturn(fund.returnSince)}</strong>
            </div>
        </section>
    `;
                return fundDiv;
            }

            // ìˆ«ì í¬ë§·íŒ…
            // function formatNumber(number) {
            //     return new Intl.NumberFormat("ko-KR").format(number);
            // }

            // ë¡œë”© ìƒíƒœ í‘œì‹œ
            function showLoading(show) {
                const loading = document.getElementById("loading");
                if (loading) {
                    loading.classList.toggle("show", show);
                }
            }

            // ë”ë³´ê¸° ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            function updateLoadMoreButton() {
                const loadMoreBtn = document.getElementById("load-more-btn");
                loadMoreBtn.disabled = isLoading;
                loadMoreBtn.textContent = isLoading ? "ë¡œë”© ì¤‘..." : "ë”ë³´ê¸°";
            }

            // ê²€ìƒ‰ ë©”ì„¸ì§€ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
            function updateResultMessage(totalCount, isFirstLoad = false) {
                const messageElement = document.querySelector(".message");

                if (!messageElement) return;

                console.log("!! : " + isFirstLoad);
                console.log("!! : " + totalCount);

                if (isFirstLoad && totalCount > 0) {
                    // ì²« ë¡œë“œì´ê³  ê²°ê³¼ê°€ ìˆì„ ë•Œë§Œ ë©”ì‹œì§€ í‘œì‹œ
                    console.log("ê²€ìƒ‰ ë©”ì„¸ì§€ ì—…ë°ì´íŠ¸");
                    messageElement.innerHTML = `
            <div class="result-summary">
                <span class="result-count">ì´ <strong>${totalCount.toLocaleString()}</strong>ê°œì˜ í€ë“œë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.</span>
            </div>
        `;
                    messageElement.classList.add("show");
                } else if (isFirstLoad && totalCount === 0) {
                    // ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ì„ ë•Œ
                    console.log("ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ - ë©”ì‹œì§€ í‘œì‹œ");
                    messageElement.innerHTML = `
            <div class="result-summary no-result">
                <span class="result-count">ê²€ìƒ‰ ì¡°ê±´ì— ë§ëŠ” í€ë“œê°€ ì—†ìŠµë‹ˆë‹¤.</span>
            </div>
        `;
                    // messageElement.classList.add("show");
                    messageElement.classList.remove("show");
                } else {
                    // ë”ë³´ê¸° ë¡œë“œ ì‹œì—ëŠ” ë©”ì‹œì§€ ìˆ¨ê¹€
                    messageElement.classList.remove("show");
                }
            }

            function setInvestTypeInfo() {
                const investTypeNames = {
                    1: "ì•ˆì •í˜•",
                    2: "ì•ˆì • ì¶”êµ¬í˜•",
                    3: "ìœ„í—˜ ì¤‘ë¦½í˜•",
                    4: "ì ê·¹ íˆ¬ìí˜•",
                    5: "ê³µê²© íˆ¬ìí˜•",
                };

                investTypeName = investTypeNames[investType] || "ì•Œ ìˆ˜ ì—†ìŒ";

                // íˆ¬ìì„±í–¥ ìš”ì†Œ ê°€ì ¸ì˜´
                const investTypeElement =
                    document.getElementById("invest-type");
                if (investTypeElement) {
                    // í…ìŠ¤íŠ¸ ì„¤ì •
                    investTypeElement.textContent = investTypeName;

                    // ê¸°ì¡´ í´ë˜ìŠ¤ ì œê±°
                    investTypeElement.className = "";

                    // íˆ¬ìì„±í–¥ì— ë§ëŠ” í´ë˜ìŠ¤ ì¶”ê°€
                    if (investType >= 1 && investType <= 5) {
                        investTypeElement.classList.add(
                            `invest-type-${investType}`
                        );
                    }
                }
            }

            // ğŸ”¥ ë©”ì‹œì§€ ì˜ì—­ì„ ë³´ì¡´í•˜ë©´ì„œ í€ë“œ ì•„ì´í…œë§Œ ì‚­ì œí•˜ëŠ” í•¨ìˆ˜
            function clearFundItems() {
                const fundList = document.getElementById("fund-list");
                const messageElement = fundList.querySelector(".message");

                // ë©”ì‹œì§€ ì˜ì—­ ì„ì‹œ ì €ì¥
                let messageHTML = "";
                if (messageElement) {
                    messageHTML = messageElement.outerHTML;
                }

                // ì „ì²´ í´ë¦¬ì–´
                fundList.innerHTML = "";

                // ë©”ì‹œì§€ ì˜ì—­ë§Œ ë‹¤ì‹œ ì¶”ê°€
                if (messageHTML) {
                    fundList.insertAdjacentHTML("afterbegin", messageHTML);
                }
            }

            // ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­ ì‹œ - ìˆ˜ì •í•„ìš”
            document
                .getElementById("fundForm")
                .addEventListener("submit", function (e) {
                    e.preventDefault();

                    // FormDataë¡œ ì²´í¬ëœ ê°’ë“¤ ìˆ˜ì§‘
                    const formData = new FormData(
                        document.getElementById("fundForm")
                    );
                    const params = new URLSearchParams();

                    // ì²´í¬ëœ ê°’ë“¤ì„ URLSearchParamsì— ì¶”ê°€
                    for (let [key, value] of formData.entries()) {
                        params.append(key, value);
                    }

                    // ì „ì—­ ë³€ìˆ˜ì— í•„í„° íŒŒë¼ë¯¸í„° ì €ì¥
                    currentFilters = params.toString();

                    console.log("ì ìš©ëœ í•„í„°:", currentFilters); // ë””ë²„ê¹…ìš©

                    // í˜ì´ì§€ ì´ˆê¸°í™”
                    currentPage = 1;
                    hasMoreData = true;

                    // ê¸°ì¡´ ê²°ê³¼ í´ë¦¬ì–´
                    document.getElementById("fund-list").innerHTML = "";

                    // ğŸ”¥ ë©”ì‹œì§€ ì˜ì—­ë§Œ ë³´ì¡´í•˜ê³  í€ë“œ ì•„ì´í…œë“¤ë§Œ ì‚­ì œ
                    // clearFundItems();

                    // ìƒˆë¡œìš´ ê²€ìƒ‰ ì‹¤í–‰
                    loadMoreFunds(); // ì´ë•Œ isFirstLoad = trueê°€ ë¨
                });

            // function showLoading() {
            //     loading.hidden = false;
            // }
            // function hideLoading() {
            //     loading.hidden = true;
            // }

            // ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
            // function showErrorMessage(message) {
            //     const errorContainer =
            //         document.getElementById("errorContainer");
            //     errorContainer.innerHTML = `
            //     <div class="error-message">
            //         ${message}
            //     </div>
            // `;
            // }

            // ì—ëŸ¬ ë©”ì‹œì§€ ì œê±°
            // function clearErrorMessage() {
            //     const errorContainer =
            //         document.getElementById("errorContainer");
            //     errorContainer.innerHTML = "";
            // }

            // ë¬´í•œ ìŠ¤í¬ë¡¤ ì˜µì…˜ (ì„ íƒì‚¬í•­)
            // window.addEventListener('scroll', function() {
            //     if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 1000) {
            //         loadMoreFunds();
            //     }
            // });
        </script>

        <!-- Thymeleaf ë°ì´í„° ì „ë‹¬ì„ ìœ„í•œ ë©”íƒ€ íƒœê·¸ -->
        <meta name="invest-type" th:content="${investType}" />
        <meta name="user-id" th:content="${userId}" />
    </body>
</html>
