<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="../../static/css/fund/fund_list.css" />
        <title>펀드 투자 - 맞춤 추천</title>

        <!-- 
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: "Malgun Gothic", sans-serif;
                background-color: #f8f9fa;
                color: #333;
                line-height: 1.6;
            }

            .container {
                max-width: 1000px;
                margin: 0 auto;
                padding: 20px;
            }

            /* 헤더 섹션 */
            .header {
                /* background: white; */
                /* padding: 24px; */
                /* border-radius: 12px; */
                /* margin-bottom: 24px; */
                /* box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06); */
            }

            .header h1 {
                font-size: 28px;
                color: #1a1a1a;
                /* margin-bottom: 8px; */
            }

            .header-info {
                color: #666;
                font-size: 14px;
            }

            .invest-type-badge {
                display: inline-block;
                background: #e3f2fd;
                color: #1976d2;
                padding: 6px 12px;
                border-radius: 16px;
                font-size: 13px;
                font-weight: 600;
                margin-left: 8px;
            }

            /* 필터 섹션 */
            .filter-section {
                /* background: white; */
                /* padding: 20px 24px; */
                /* border-radius: 12px; */
                /* margin-bottom: 24px; */
                /* box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06); */
            }

            .filter-info {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 16px;
            }

            .total-count {
                font-size: 16px;
                color: #333;
            }

            .total-count .count {
                color: #1976d2;
                font-weight: 600;
            }

            .view-options {
                display: flex;
                gap: 8px;
                align-items: center;
            }

            .view-toggle {
                padding: 8px 12px;
                border: 1px solid #ddd;
                background: white;
                border-radius: 6px;
                cursor: pointer;
                font-size: 12px;
            }

            .view-toggle.active {
                background: #1976d2;
                color: white;
                border-color: #1976d2;
            }

            /* 펀드 리스트 테이블 */
            .fund-table {
                background: white;
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            }

            .table-header {
                background: #f8f9fa;
                border-bottom: 1px solid #e9ecef;
            }

            .table-header-row {
                display: grid;
                grid-template-columns: 4fr 0.8fr 0.8fr 0.8fr 0.8fr 0.8fr 1fr 0.8fr;
                padding: 16px;
                font-weight: 600;
                font-size: 14px;
                color: #495057;
                align-items: center;
                border-right: 1px solid #e9ecef;
            }

            .table-header-row > div {
                border-right: 1px solid #e9ecef;
                padding-right: 8px;
                text-align: center;
            }

            .table-header-row > div:first-child {
                /* text-align: left; */
                /* padding-left: 0; */
            }

            .table-header-row > div:last-child {
                border-right: none;
            }

            /* 수익률(%) 헤더 스타일 */
            .returns-header {
                position: relative;
                display: flex;
                flex-direction: column;
                align-items: center;
                grid-column: span 5;
                border-right: 1px solid #e9ecef;
                padding: 8px;
            }

            .returns-title {
                font-weight: 700;
                font-size: 15px;
                color: #333;
                margin-bottom: 8px;
                border-bottom: 1px solid #e9ecef;
                padding-bottom: 4px;
                width: 100%;
                text-align: center;
            }

            .returns-periods {
                display: grid;
                grid-template-columns: repeat(5, 1fr);
                width: 100%;
                gap: 1px;
            }

            .period-header {
                font-size: 12px;
                color: #666;
                text-align: center;
                padding: 2px;
            }

            .fund-item {
                display: grid;
                grid-template-columns: 4fr 0.8fr 0.8fr 0.8fr 0.8fr 0.8fr 1fr 0.8fr;
                padding: 16px;
                border-bottom: 1px solid #f1f3f4;
                align-items: center;
                transition: background-color 0.2s ease;
            }

            .fund-item > div {
                border-right: 1px solid #f1f3f4;
                padding-right: 8px;
            }

            .fund-item > div:first-child {
                padding-left: 0;
            }

            .fund-item > div:last-child {
                border-right: none;
            }

            .fund-item:hover {
                background-color: #f8f9fa;
            }

            .fund-item:last-child {
                border-bottom: none;
            }

            /* 펀드 정보 영역 */
            .fund-info {
                padding-right: 16px;
            }

            .fund-name {
                font-size: 16px;
                font-weight: 600;
                color: #1a1a1a;
                margin-bottom: 8px;
                line-height: 1.4;
                cursor: pointer;
                transition: color 0.2s ease;
            }

            .fund-name:hover {
                color: #1976d2;
                text-decoration: underline;
            }

            .fund-name-link {
                color: inherit;
                text-decoration: none;
                display: block;
            }

            .fund-name-link:hover {
                color: #1976d2;
            }

            .fund-details {
                display: flex;
                flex-wrap: wrap;
                gap: 8px;
                font-size: 12px;
                color: #666;
            }

            .fund-tag {
                background: #f1f3f4;
                padding: 3px 8px;
                border-radius: 4px;
                white-space: nowrap;
            }

            .risk-level {
                background: #fff3e0;
                color: #ef6c00;
                padding: 3px 8px;
                border-radius: 4px;
                font-weight: 500;
            }

            /* 수익률 표시 */
            .return-value {
                text-align: center;
                font-weight: 600;
                font-size: 14px;
            }

            .return-positive {
                color: #d32f2f;
            }

            .return-negative {
                color: #1976d2;
            }

            .return-neutral {
                color: #666;
            }

            /* 기타 정보 */
            .fund-scale {
                text-align: center;
                color: #666;
                font-size: 13px;
            }

            .fund-fee {
                text-align: center;
                color: #666;
                font-size: 13px;
            }

            /* 더보기 버튼 */
            .load-more-container {
                text-align: center;
                margin-top: 32px;
            }

            .load-more-btn {
                background: #d32f2f;
                color: white;
                border: none;
                padding: 14px 32px;
                border-radius: 8px;
                font-size: 14px;
                font-weight: 500;
                cursor: pointer;
                transition: background 0.2s;
                display: inline-flex;
                align-items: center;
                gap: 8px;
            }

            .load-more-btn:hover {
                background: #b71c1c;
            }

            .load-more-btn:disabled {
                background: #ccc;
                cursor: not-allowed;
            }

            /* 로딩 스피너 */
            .loading-spinner {
                width: 16px;
                height: 16px;
                border: 2px solid #ffffff;
                border-top: 2px solid transparent;
                border-radius: 50%;
                animation: spin 1s linear infinite;
            }

            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }

            /* 에러 및 상태 메시지 */
            .message {
                padding: 16px;
                border-radius: 8px;
                margin-bottom: 16px;
                text-align: center;
            }

            .message.error {
                background: #ffebee;
                color: #c62828;
                border: 1px solid #ffcdd2;
            }

            .message.info {
                background: #e3f2fd;
                color: #1976d2;
                border: 1px solid #bbdefb;
            }

            .no-data {
                text-align: center;
                padding: 60px 20px;
                color: #666;
                background: white;
                border-radius: 12px;
            }

            .no-data-icon {
                font-size: 48px;
                margin-bottom: 16px;
                opacity: 0.3;
            }

            /* 반응형 디자인 */
            @media (max-width: 1000px) {
                .table-header-row,
                .fund-item {
                    grid-template-columns: 4fr 0.6fr 0.6fr 0.6fr 0.6fr 0.6fr 0.8fr 0.6fr;
                }

                .returns-periods {
                    font-size: 11px;
                }

                .fund-scale,
                .fund-fee {
                    font-size: 12px;
                }
            }

            @media (max-width: 768px) {
                .container {
                    padding: 16px;
                }

                .table-header-row,
                .fund-item {
                    grid-template-columns: 1fr;
                    gap: 12px;
                }

                .returns-header {
                    grid-column: span 1;
                }

                .fund-table {
                    overflow-x: auto;
                }

                .returns-periods {
                    grid-template-columns: repeat(5, 1fr);
                    gap: 4px;
                }
            }
        </style>
        -->
    </head>
    <body>
        <div class="container">
            <!-- 제목 영역 -->
            <div class="title-container">
                <h1 class="title">맞춤 펀드 추천</h1>
                <p class="title-sub">
                    원하는 조건을 선택하고 원하는 펀드를 찾아보세요.
                </p>
            </div>

            <!-- 필터 영역 -->
            <form id="fundForm" class="filter-container">
                <!-- 위험등급 -->
                <fieldset class="row">
                    <legend class="row-label">위험등급</legend>
                    <div class="options">
                        <label for="risk1">
                            <input
                                type="checkbox"
                                id="risk1"
                                name="risk[]"
                                value="1"
                            />
                            매우높은위험(1등급)
                        </label>

                        <label for="risk2">
                            <input
                                type="checkbox"
                                id="risk2"
                                name="risk[]"
                                value="2"
                            />
                            높은위험(2등급)
                        </label>

                        <label for="risk3">
                            <input
                                type="checkbox"
                                id="risk3"
                                name="risk[]"
                                value="3"
                            />
                            다소높은위험(3등급)
                        </label>

                        <label for="risk4">
                            <input
                                type="checkbox"
                                id="risk4"
                                name="risk[]"
                                value="4"
                            />
                            보통위험(4등급)
                        </label>

                        <label for="risk5">
                            <input
                                type="checkbox"
                                id="risk5"
                                name="risk[]"
                                value="5"
                            />
                            낮은위험(5등급)
                        </label>

                        <label for="risk6">
                            <input
                                type="checkbox"
                                id="risk6"
                                name="risk[]"
                                value="6"
                            />
                            매우낮은위험(6등급)
                        </label>
                    </div>
                </fieldset>

                <!-- 펀드유형 -->
                <fieldset class="row">
                    <legend class="row-label">펀드유형</legend>
                    <div class="options">
                        <label for="type_mmf">
                            <input
                                type="checkbox"
                                id="type_mmf"
                                name="type[]"
                                value="MMF"
                            />
                            MMF
                        </label>

                        <label for="type_bond">
                            <input
                                type="checkbox"
                                id="type_bond"
                                name="type[]"
                                value="채권형"
                            />
                            채권형
                        </label>

                        <label for="type_bmix">
                            <input
                                type="checkbox"
                                id="type_bmix"
                                name="type[]"
                                value="채권혼합형"
                            />
                            채권혼합형
                        </label>

                        <label for="type_smix">
                            <input
                                type="checkbox"
                                id="type_smix"
                                name="type[]"
                                value="주식혼합형"
                            />
                            주식혼합형
                        </label>

                        <label for="type_stock">
                            <input
                                type="checkbox"
                                id="type_stock"
                                name="type[]"
                                value="주식형"
                            />
                            주식형
                        </label>

                        <label for="type_deriv">
                            <input
                                type="checkbox"
                                id="type_deriv"
                                name="type[]"
                                value="파생상품형"
                            />
                            파생상품형
                        </label>

                        <label for="type_fof">
                            <input
                                type="checkbox"
                                id="type_fof"
                                name="type[]"
                                value="재간접"
                            />
                            재간접
                        </label>
                    </div>
                </fieldset>

                <!-- 투자 지역 -->
                <fieldset class="row">
                    <legend class="row-label">투자 지역</legend>
                    <div class="options">
                        <label for="reg_kr">
                            <input
                                type="checkbox"
                                id="reg_kr"
                                name="region[]"
                                value="KR"
                            />
                            국내
                        </label>

                        <label for="reg_gl">
                            <input
                                type="checkbox"
                                id="reg_gl"
                                name="region[]"
                                value="GL"
                            />
                            글로벌
                        </label>
                    </div>
                </fieldset>

                <!-- 검색 버튼 -->
                <div class="row filter-btn-container">
                    <button type="submit" class="filter-search-btn">
                        필터 검색
                    </button>
                </div>
            </form>

            <!-- 검색 결과 메세지 영역 -->
            <div class="message"></div>

            <!-- 펀드 리스트 영역 -->
            <div id="fund-list" class="fund-list">
                <!-- 카드 1개 예시 -->
                <div class="fund-item" data-id="1">
                    <!-- 메타 데이터 -->
                    <section class="fund-item-section fund-meta">
                        <div class="fund-name-container">
                            <h3 class="fund-name">
                                삼성KRX300 2배레버리지증권투자신탁
                            </h3>
                        </div>
                        <ul class="fund-detail">
                            <li>설정일&nbsp;2021-09-29</li>
                            <li>기준가&nbsp;1,303.92</li>
                            <li>순자산&nbsp;45.2억</li>
                        </ul>
                        <div class="badge-list">
                            <span class="badge company">삼성자산운용</span>
                            <span class="badge type">주식형</span>
                            <span class="badge region">글로벌</span>
                            <span class="badge risk risk-2"
                                >높은위험(2등급)</span
                            >
                        </div>
                    </section>

                    <!-- 수익률 -->
                    <section class="fund-item-section fund-return">
                        <div class="stat">
                            <span>1개월</span>
                            <strong class="pos">22.81%</strong>
                        </div>
                        <div class="stat">
                            <span>3개월</span>
                            <strong class="pos">69.95%</strong>
                        </div>
                        <div class="stat">
                            <span>6개월</span>
                            <strong class="pos">62.87%</strong>
                        </div>
                        <div class="stat">
                            <span>12개월</span>
                            <strong class="pos">75.22%</strong>
                        </div>
                        <div class="stat">
                            <span>누적</span>
                            <strong class="pos">32.08%</strong>
                        </div>
                    </section>
                </div>

                <!-- 카드 1개 예시 -->
                <div class="fund-item" data-id="1">
                    <!-- 메타 데이터 -->
                    <section class="fund-item-section fund-meta">
                        <div class="fund-name-container">
                            <h3 class="fund-name">
                                삼성KRX300 2배레버리지증권투자신탁
                            </h3>
                        </div>
                        <ul class="fund-detail">
                            <li>설정일&nbsp;2021-09-29</li>
                            <li>기준가&nbsp;1,303.92</li>
                            <li>순자산&nbsp;45.2억</li>
                        </ul>
                        <div class="badge-list">
                            <span class="badge company">삼성자산운용</span>
                            <span class="badge type">주식형</span>
                            <span class="badge region">글로벌</span>
                            <span class="badge risk risk-2"
                                >높은위험(2등급)</span
                            >
                        </div>
                    </section>

                    <!-- 수익률 -->
                    <section class="fund-item-section fund-return">
                        <div class="stat">
                            <span>1개월</span>
                            <strong class="pos">22.81%</strong>
                        </div>
                        <div class="stat">
                            <span>3개월</span>
                            <strong class="pos">69.95%</strong>
                        </div>
                        <div class="stat">
                            <span>6개월</span>
                            <strong class="pos">62.87%</strong>
                        </div>
                        <div class="stat">
                            <span>12개월</span>
                            <strong class="pos">75.22%</strong>
                        </div>
                        <div class="stat">
                            <span>누적</span>
                            <strong class="pos">32.08%</strong>
                        </div>
                    </section>
                </div>

                <!-- 카드 1개 예시 -->
                <div class="fund-item" data-id="1">
                    <!-- 메타 데이터 -->
                    <section class="fund-item-section fund-meta">
                        <div class="fund-name-container">
                            <h3 class="fund-name">
                                삼성KRX300 2배레버리지증권투자신탁
                            </h3>
                        </div>
                        <ul class="fund-detail">
                            <li>설정일&nbsp;2021-09-29</li>
                            <li>기준가&nbsp;1,303.92</li>
                            <li>순자산&nbsp;45.2억</li>
                        </ul>
                        <div class="badge-list">
                            <span class="badge company">삼성자산운용</span>
                            <span class="badge type">주식형</span>
                            <span class="badge region">글로벌</span>
                            <span class="badge risk risk-2"
                                >높은위험(2등급)</span
                            >
                        </div>
                    </section>

                    <!-- 수익률 -->
                    <section class="fund-item-section fund-return">
                        <div class="stat">
                            <span>1개월</span>
                            <strong class="pos">22.81%</strong>
                        </div>
                        <div class="stat">
                            <span>3개월</span>
                            <strong class="pos">69.95%</strong>
                        </div>
                        <div class="stat">
                            <span>6개월</span>
                            <strong class="pos">62.87%</strong>
                        </div>
                        <div class="stat">
                            <span>12개월</span>
                            <strong class="pos">75.22%</strong>
                        </div>
                        <div class="stat">
                            <span>누적</span>
                            <strong class="pos">32.08%</strong>
                        </div>
                    </section>
                </div>

                <!-- 카드 1개 예시 -->
                <div class="fund-item" data-id="1">
                    <!-- 메타 데이터 -->
                    <section class="fund-item-section fund-meta">
                        <div class="fund-name-container">
                            <h3 class="fund-name">
                                삼성KRX300 2배레버리지증권투자신탁
                            </h3>
                        </div>
                        <ul class="fund-detail">
                            <li>설정일&nbsp;2021-09-29</li>
                            <li>기준가&nbsp;1,303.92</li>
                            <li>순자산&nbsp;45.2억</li>
                        </ul>
                        <div class="badge-list">
                            <span class="badge company">삼성자산운용</span>
                            <span class="badge type">주식형</span>
                            <span class="badge region">글로벌</span>
                            <span class="badge risk risk-2"
                                >높은위험(2등급)</span
                            >
                        </div>
                    </section>

                    <!-- 수익률 -->
                    <section class="fund-item-section fund-return">
                        <div class="stat">
                            <span>1개월</span>
                            <strong class="pos">22.81%</strong>
                        </div>
                        <div class="stat">
                            <span>3개월</span>
                            <strong class="pos">69.95%</strong>
                        </div>
                        <div class="stat">
                            <span>6개월</span>
                            <strong class="pos">62.87%</strong>
                        </div>
                        <div class="stat">
                            <span>12개월</span>
                            <strong class="pos">75.22%</strong>
                        </div>
                        <div class="stat">
                            <span>누적</span>
                            <strong class="pos">32.08%</strong>
                        </div>
                    </section>
                </div>
            </div>

            <!-- 더보기 버튼 영역 -->
            <div class="load-more-container">
                <button id="load-more-btn" class="load-more-btn">더보기</button>
            </div>
        </div>

        <footer class="page-footer">
            <div class="footer-inner">
                <!-- 회사·서비스 정보 -->
                <section class="footer-info">
                    <h4 class="footer-logo">FUND<span>INFO</span></h4>
                    <p>
                        (주) 펀드인포 &nbsp;|&nbsp; 대표 홍길동 &nbsp;|&nbsp;
                        사업자등록번호 123‑45‑67890<br />
                        서울특별시 영등포구 여의대로 97 3F&nbsp; ( 우 07320 )
                    </p>
                    <p class="copyright">
                        © 2025 FUNDINFO Co., Ltd. All rights reserved.
                    </p>
                </section>

                <!-- 메뉴 링크 -->
                <nav class="footer-nav">
                    <ul>
                        <li><a href="#">서비스 소개</a></li>
                        <li><a href="#">이용약관</a></li>
                        <li><a href="#">개인정보처리방침</a></li>
                        <li><a href="#">고객센터</a></li>
                    </ul>
                </nav>

                <!-- SNS / 연락처 -->
                <section class="footer-contact">
                    <p>
                        <strong>고객센터 | 1588‑0000</strong
                        ><br />평일 09:00‑18:00
                    </p>
                    <div class="sns">
                        <a href="#" aria-label="페이스북">📘</a>
                        <a href="#" aria-label="트위터">🐦</a>
                        <a href="#" aria-label="링크드인">💼</a>
                    </div>
                </section>
            </div>
        </footer>

        <script>
            // 전역 변수
            let currentPage = 1; // 현재 로딩할 페이지 번호를 저장
            let pageSize = 10; // 페이지의 최대 요청 갯수
            let isLoading = false; // 현재 API 호출 중인지 상태를 나타내는 플래그
            let hasMoreData = true; // 더 가져올 데이터가 있는지 여부를 나타내는 플래그
            let investType = null; // 사용자의 투자 성향 타입 번호를 저장
            let investTypeName = ""; // 투자 성향 타입의 한글 이름을 저장

            // 페이지 로드 시 초기화
            // HTML 문서가 완전히 로드된 후 초기화 작업 수행
            document.addEventListener("DOMContentLoaded", function () {
                // Thymeleaf에서 전달된 데이터 가져오기
                // 메타 태그 검색: document.querySelector()로 HTML의 메타 태그에서 투자 성향 정보 찾기
                const investTypeElement = document.querySelector(
                    'meta[name="invest-type"]'
                );
                const userIdElement = document.querySelector(
                    'meta[name="user-id"]'
                );

                // 데이터 파싱: parseInt()로 문자열을 숫자로 변환하여 investType 변수에 저장
                if (investTypeElement) {
                    investType = parseInt(
                        investTypeElement.getAttribute("content")
                    );
                }

                // 투자 성향 정보 설정
                // setInvestTypeInfo() 호출로 화면에 표시할 투자 성향 이름 설정
                setInvestTypeInfo();

                // 초기 데이터 로드
                // loadMoreFunds() 호출로 첫 번째 페이지 데이터 가져오기
                loadMoreFunds();
            });

            // 투자 성향 정보 설정
            // 투자 성향 숫자를 한글 이름으로 변환하여 화면에 표시
            function setInvestTypeInfo() {
                const investTypeNames = {
                    1: "안전 추구형",
                    2: "안전 선호형",
                    3: "위험 중립형",
                    4: "적극 투자형",
                    5: "공격 투자형",
                };

                investTypeName = investTypeNames[investType] || "알 수 없음";
                document.getElementById("investTypeName").textContent =
                    investTypeName;
            }

            // 더 많은 펀드 로드
            // 서버에서 펀드 데이터를 가져와 화면에 추가하는 핵심 함수
            async function loadMoreFunds() {
                // 중복 호출 방지
                if (isLoading || !hasMoreData) return;

                // 로딩 상태 설정
                isLoading = true;
                showLoading(true);
                updateLoadMoreButton();

                try {
                    // API 호출
                    const response = await fetch(
                        `/api/funds/list?page=${currentPage}&limit=${pageSize}&investType=${investType}`
                    );
                    const data = await response.json();

                    if (data.success) {
                        // 성공 시 데이터 처리
                        const funds = data.data.funds;
                        const pagination = data.pagination;

                        // 펀드 목록 렌더링
                        renderFunds(funds);

                        // 페이지 정보 업데이트
                        currentPage++;
                        hasMoreData = pagination.hasNext;

                        // 더보기 버튼 상태 업데이트
                        if (!hasMoreData) {
                            document.getElementById(
                                "loadMoreBtn"
                            ).style.display = "none";
                            document.getElementById(
                                "noMoreData"
                            ).style.display = "block";
                        }

                        // 에러 메시지 제거
                        clearErrorMessage();
                    } else {
                        // 실패 시 에러 처리
                        showErrorMessage(
                            data.message ||
                                "펀드 정보를 불러오는데 실패했습니다."
                        );
                    }
                } catch (error) {
                    // 네트워크 오류 처리
                    console.error("펀드 로드 오류:", error);
                    showErrorMessage(
                        "서버 연결에 실패했습니다. 잠시 후 다시 시도해주세요."
                    );
                } finally {
                    // 로딩 상태 해제
                    isLoading = false;
                    showLoading(false);
                    updateLoadMoreButton();
                }
            }

            // 펀드 목록 렌더링
            // 펀드 배열을 받아서 화면에 렌더링
            function renderFunds(funds) {
                // 펀드 목록을 담을 컨테이너 요소 찾기
                const fundList = document.getElementById("fund-list");

                funds.forEach((fund) => {
                    // 각 펀드의 HTML 요소 생성
                    const fundElement = createFundElement(fund);
                    // 생성된 요소를 컨테이너에 추가
                    fundList.appendChild(fundElement);
                });
            }

            // 펀드 요소 생성
            // 개별 펀드 데이터를 HTML 요소로 변환
            function createFundElement(fund) {
                const fundDiv = document.createElement("div"); // div 요소 생성
                fundDiv.className = "fund-item"; // 클래스 fund-item 적용

                // 수익률 클래스 결정
                // 기간별 수익률
                const return1mStatClassName =
                    fund.return1m >= 0 ? "pos" : "neg";
                const return3mStatClassName =
                    fund.return3m >= 0 ? "pos" : "neg";
                const return6mStatClassName =
                    fund.return6m >= 0 ? "pos" : "neg";
                const return12mStatClassName =
                    fund.return12m >= 0 ? "pos" : "neg";

                // 펀드ID 추출

                // 펀드명 추출
                // 설정일 추출
                // 기준가 추출
                // 순자산 추출

                // 운용사 추출
                // 펀드 유형 추출
                // 투자 지역 추출
                //

                const returnClass =
                    fund.return1Year >= 0
                        ? "return-positive"
                        : "return-negative";
                const returnSign = fund.return1Year >= 0 ? "+" : "";

                fundDiv.innerHTML = `
                    <div class="fund-header">
                        <div>
                            <div class="fund-name">${fund.fundName}</div>
                            <div class="fund-company">${fund.company}</div>
                        </div>
                        <div class="fund-type">${fund.fundType}</div>
                    </div>
                    <div class="fund-details">
                        <div class="detail-item">
                            <span class="detail-label">기준가</span>
                            <span class="detail-value">${formatNumber(
                                fund.basePrice
                            )}원</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">전일대비</span>
                            <span class="detail-value ${returnClass}">${returnSign}${formatNumber(
                    fund.dailyChange
                )}원</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">1년 수익률</span>
                            <span class="detail-value ${returnClass}">${returnSign}${
                    fund.return1Year
                }%</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">위험등급</span>
                            <span class="detail-value">${
                                fund.riskLevel
                            }등급</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">투자지역</span>
                            <span class="detail-value">${
                                fund.investmentRegion
                            }</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">최소가입금액</span>
                            <span class="detail-value">${formatNumber(
                                fund.minInvestAmount
                            )}원</span>
                        </div>
                    </div>
                `;

                return fundDiv;
            }

            // 숫자 포맷팅
            function formatNumber(number) {
                return new Intl.NumberFormat("ko-KR").format(number);
            }

            // 로딩 상태 표시
            function showLoading(show) {
                const loading = document.getElementById("loading");
                if (show) {
                    loading.classList.add("show");
                } else {
                    loading.classList.remove("show");
                }
            }

            // 더보기 버튼 상태 업데이트
            function updateLoadMoreButton() {
                const loadMoreBtn = document.getElementById("loadMoreBtn");
                loadMoreBtn.disabled = isLoading;
                loadMoreBtn.textContent = isLoading ? "로딩 중..." : "더보기";
            }

            // 에러 메시지 표시
            function showErrorMessage(message) {
                const errorContainer =
                    document.getElementById("errorContainer");
                errorContainer.innerHTML = `
                <div class="error-message">
                    ${message}
                </div>
            `;
            }

            // 에러 메시지 제거
            function clearErrorMessage() {
                const errorContainer =
                    document.getElementById("errorContainer");
                errorContainer.innerHTML = "";
            }

            // 무한 스크롤 옵션 (선택사항)
            // window.addEventListener('scroll', function() {
            //     if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 1000) {
            //         loadMoreFunds();
            //     }
            // });
        </script>
    </body>
</html>
